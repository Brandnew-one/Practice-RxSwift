# ğŸ¤¦Â íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

## Observableì„ êµ¬ë…í•˜ë©´ ì‹œí€€ìŠ¤ê°€ í•­ìƒ ì¢…ë£Œë ê¹Œ?

ê²°ë¡ ë¶€í„° ë§í•˜ìë©´ `No`ë‹¤

```swift
let disposeBag = DisposeBag()
Observable.create { observer -> Disposable in
  observer.on(.next(1))
  observer.on(.next(2))
  observer.on(.completed)
  observer.on(.next(3)) // ì´ë¯¸ ìƒëª…ì£¼ê¸° ì¢…ë£Œë˜ì—ˆê¸° ë•Œë¬¸ì— ë°©ì¶œë˜ì§€ ì•ŠìŒ
  return Disposables.create()
}
.subscribe(
  onNext: {
    print($0)
  },
  onCompleted: {
    print("completed")
  },
  onDisposed: {
    print("Disposed")
  }
)
.disposed(by: disposeBag)

// 1
// 2
// completed
// Disposed
```

createë¥¼ í†µí•´ì„œ Observableì„ ìƒì„±í•  ë•Œ completed ì´ë²¤íŠ¸ë¥¼ ë„˜ê²¨ì¤˜ì•¼ í•´ë‹¹ Observableì´ êµ¬ë…ë˜ëŠ” ì‹œì ì— completed ì´ë²¤íŠ¸ë¥¼ ë°©ì¶œí•˜ê³  ì¢…ë£Œëœë‹¤.

```swift
let disposeBag = DisposeBag()
Observable.create { observer -> Disposable in
  observer.on(.next(1))
  observer.on(.next(2))
//  observer.on(.completed)
  observer.on(.next(3))
  return Disposables.create()
}
.subscribe(
  onNext: {
    print($0)
  },
  onCompleted: {
    print("completed")
  },
  onDisposed: {
    print("Disposed")
  }
)
.disposed(by: disposeBag)
// 1
// 2
// 3
```

ê·¸ë ‡ê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì´ completed ì´ë²¤íŠ¸ê°€ ì—†ëŠ” ê²½ìš°ì—ëŠ” completedê°€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¼ ìš°ë¦¬ê°€ just, of, from ì„ í†µí•´ì„œ ìƒì„±í•´ë‚¸ Observableì€ ì–´ë–»ê²Œ ë˜ëŠ”ê±¸ê¹Œ?

```swift
let test = Observable.of("í…Œ", "ìŠ¤", "íŠ¸")
test
  .subscribe(
    onNext: {
      print($0)
    },
    onError: {
      print($0)
    },
    onCompleted: {
      print("Completed")
    },
    onDisposed: {
      print("Disposed")
    }
  )
  .disposed(by: disposeBag)

// í…Œ
// ìŠ¤
// íŠ¸
// Completed
// Disposed
```

Completed ì´ë²¤íŠ¸ê°€ ë°©ì¶œë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ìš°ë¦¬ê°€ Completed ì´ë²¤íŠ¸ë¥¼ ë”°ë¡œ ì •ì˜í•˜ì§€ ì•Šì•˜ëŠ”ë° ì–´ë–»ê²Œ ê°€ëŠ¥í•œê±¸ê¹Œ?

```swift
public static func of(
	_ elements: Element ..., 
	scheduler: ImmediateSchedulerType = CurrentThreadScheduler.instance
) -> Observable<Element> {
	ObservableSequence(elements: elements, scheduler: scheduler)
}
```

of ì˜ êµ¬í˜„ë¶€ë¥¼ ë³´ë©´ ObservableSequenceë¥¼ ë°˜í™˜í•œë‹¤. 

```swift
final private class ObservableSequence<Sequence: Swift.Sequence>: Producer<Sequence.Element> {
    fileprivate let elements: Sequence
    fileprivate let scheduler: ImmediateSchedulerType

    init(elements: Sequence, scheduler: ImmediateSchedulerType) {
        self.elements = elements
        self.scheduler = scheduler
    }

    override func run<Observer: ObserverType>(_ observer: Observer, cancel: Cancelable) -> (sink: Disposable, subscription: Disposable) where Observer.Element == Element {
        let sink = ObservableSequenceSink(parent: self, observer: observer, cancel: cancel)
        let subscription = sink.run()
        return (sink: sink, subscription: subscription)
    }
}
```

ObservableSequenceëŠ” sink.runì„ í†µí•´ êµ¬ë…ì„ ì‹¤í–‰í•˜ê²Œ ë˜ëŠ”ë° 

```swift
func run() -> Disposable {
        return self.parent.scheduler.scheduleRecursive(self.parent.elements.makeIterator()) { iterator, recurse in
            var mutableIterator = iterator
            if let next = mutableIterator.next() {
                self.forwardOn(.next(next))
                recurse(mutableIterator)
            }
            else {
                self.forwardOn(.completed)
                self.dispose()
            }
        }
    }
```

runë©”ì„œë“œë¥¼ í™•ì¸í•´ë³´ë©´ ObservableSquenceì˜ ë‹¤ìŒ elementê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ëŠ” nextì´ë²¤íŠ¸ë¥¼ ë°©ì¶œí•˜ì§€ë§Œ ì´ë²¤íŠ¸ë¥¼ ëª¨ë‘ ë°©ì¶œí•˜ê³  ë‹¤ìŒ elementê°€ ì—†ëŠ” ê²½ìš°ì—ëŠ” completedì™€ disposeë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

```swift
final private class Just<Element>: Producer<Element> {
    private let element: Element
    
    init(element: Element) {
        self.element = element
    }
    
    override func subscribe<Observer: ObserverType>(_ observer: Observer) -> Disposable where Observer.Element == Element {
        observer.on(.next(self.element))
        observer.on(.completed)
        return Disposables.create()
    }
}
```

just ë˜í•œ í•˜ë‚˜ì˜ ì´ë²¤íŠ¸ë¥¼ nextë¡œ ë°©ì¶œí•˜ê³  completed ì´ë²¤íŠ¸ë¥¼ ë°©ì¶œí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

ì¦‰, ìš°ë¦¬ê°€ Observableì„ just, of, fromì„ í†µí•´ì„œ ìƒì„±í•˜ê³  í•´ë‹¹ Observableì„ êµ¬ë…í•˜ë©´ nextì´ë²¤íŠ¸ë¥¼ ëª¨ë‘ ë°©ì¶œí•˜ê³  ì•Œì•„ì„œ complete ì´ë²¤íŠ¸ë¥¼ ë°©ì¶œí•´ ì‹œí€€ìŠ¤ê°€ ì¢…ë£Œëœë‹¤.

í•˜ì§€ë§Œ createë¥¼ í†µí•´ í™•ì¸í–ˆë“¯ì´ ëª¨ë“  Observableì´ ë‹¨ìˆœíˆ subscribeí•œë‹¤ê³  í•´ì„œ completed ì´ë²¤íŠ¸ë¥¼ ë°©ì¶œí•˜ë©´ì„œ ì‹œí€€ìŠ¤ê°€ ì¢…ë£Œë˜ëŠ”ê²ƒì€ ì•„ë‹ˆë‹¤!